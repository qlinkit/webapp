var JsonFormatter={stringify:function(d){var c={ct:d.ciphertext.toString(CryptoJS.enc.Base64)};if(d.iv){c.iv=d.iv.toString()}if(d.salt){c.s=d.salt.toString()}return JSON.stringify(c)},parse:function(e){var f=JSON.parse(e);var d=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(f.ct)});if(f.iv){d.iv=CryptoJS.enc.Hex.parse(f.iv)}if(f.s){d.salt=CryptoJS.enc.Hex.parse(f.s)}return d}};var qrConfig={width:110,height:110,colorDark:"#f3f3f3",colorLight:"#191919",correctLevel:QRCode.CorrectLevel.H};var flash_active=false;var is_mobile_or_tablet=false;var is_ipad_type=false;var password=null;var minPasswordLength=25;var maxPasswordLength=30;var fwLimit=5;var trkLength=10;var localeCode;var localeMessages;var wsh="";var dencFiles=[];var totalIndex=0;var encFiles=[];var namesFiles=[];var sha256=null;$(document).ready(function(){init()});var rawData="";var points=0;var strongPoints=1000;var entropy=0;var minX=999999;var maxX=-999999;var sminX=999999;var smaxX=-999999;var sizeX=window.screen.width;var minY=9999999;var maxY=-9999999;var sminY=9999999;var smaxY=-9999999;var rangeX=0;var rangeY=0;var sizeY=window.screen.height;$(document).bind("mobileinit",function(a){$.extend($.mobile.zoom,{locked:true,enabled:false})});function init(){var f=Math.floor(Math.random()*10);$("body").addClass("bg"+f);$("#new-qlink-button-container-mobile-container").hide();if(!(window.File&&window.FileReader&&window.FileList&&window.Blob)){$(".file-input-wrapper").hide();$("#files").hide()}sha256=CryptoJS.algo.SHA256.create();var i=CryptoJS.lib.WordArray.random(128);var e=$("#x_token");var h=$('[name="_token"]');var d=(new Date().getTime()).toString()+i+e.val()+h.val();sha256.update(d);rawData=d;$("#qlink_textarea").click(function(a){document.body.scrollTop=document.documentElement.scrollTop=0});$("#qlink_textarea").keypress(function(a){if(Math.floor((Math.random()*10)+1)<=3){var b=CryptoJS.lib.WordArray.random(128);sha256.update((new Date().getTime()).toString()*a.timeStamp+a.keyCode.toString());rawData=rawData+(new Date().getTime()).toString()*a.timeStamp+b+a.keyCode.toString();updateStrengthBar(10000,10000)}});$("#qlink_textarea").bind("vmousemove",function(a){if(a.pageX<minX){minX=a.pageX}if(a.pageX>maxX){maxX=a.pageX}if(a.pageY<minY){minY=a.pageY}if(a.pageY>maxY){maxY=a.pageY}var b=CryptoJS.lib.WordArray.random(128);sha256.update((new Date().getTime()).toString()+b+a.pageX+a.pageY);rawData=rawData+(new Date().getTime()).toString()+b+a.clientX*a.timeStamp+a.clientY*a.timeStamp;if(smaxX-sminX>maxX-minX){rangeX=smaxX-sminX}else{rangeX=maxX-minX}if(smaxY-sminY>maxY-minY){rangeY=smaxY-sminY}else{rangeY=maxY-minY}updateStrengthBar(rangeX,rangeY)});$(window).scroll(function(a){if(a.target.scrollX<sminX){sminX=a.target.scrollX}if(a.target.scrollX>smaxX){smaxX=a.target.scrollX}if(a.target.scrollY<sminY){sminY=a.target.scrollY}if(a.target.scrollY>smaxY){smaxY=a.target.scrollY}var b=CryptoJS.lib.WordArray.random(128);sha256.update((new Date().getTime()).toString()+b+a.target.scrollX+a.target.scrollY);rawData=rawData+(new Date().getTime()).toString()+b+a.target.scrollX*a.timeStamp+a.target.scrollY*a.timeStamp;if(smaxX-sminX>maxX-minX){rangeX=smaxX-sminX}else{rangeX=maxX-minX}if(smaxY-sminY>maxY-minY){rangeY=smaxY-sminY}else{rangeY=maxY-minY}updateStrengthBar(rangeX,rangeY)});$("body").bind("vmousemove",function(a){if(a.pageX<minX){minX=a.pageX}if(a.pageX>maxX){maxX=a.pageX}if(a.pageY<minY){minY=a.pageY}if(a.pageY>maxY){maxY=a.pageY}var b=CryptoJS.lib.WordArray.random(128);sha256.update((new Date().getTime()).toString()+b+a.pageX+a.pageY);rawData=rawData+(new Date().getTime()).toString()+b+a.pageX*a.timeStamp+a.pageY*a.timeStamp;if(smaxX-sminX>maxX-minX){rangeX=smaxX-sminX}else{rangeX=maxX-minX}if(smaxY-sminY>maxY-minY){rangeY=smaxY-sminY}else{rangeY=maxY-minY}updateStrengthBar(rangeX,rangeY)});$("body").bind("tap",function(a){if(a.pageX<minX){minX=a.pageX}if(a.pageX>maxX){maxX=a.pageX}if(a.pageY<minY){minY=a.pageY}if(a.pageY>maxY){maxY=a.pageY}var b=CryptoJS.lib.WordArray.random(128);sha256.update((new Date().getTime()).toString()+b+a.pageX+a.pageY);rawData=rawData+(new Date().getTime()).toString()+b+a.pageX*a.timeStamp+a.pageY*a.timeStamp;if(smaxX-sminX>maxX-minX){rangeX=smaxX-sminX}else{rangeX=maxX-minX}if(smaxY-sminY>maxY-minY){rangeY=smaxY-sminY}else{rangeY=maxY-minY}updateStrengthBar(rangeX,rangeY)});var g=false;$("#toggle_entropy_viewer").click(function(a){if(g){$("#entropy-viewer").toggle(false);g=false}else{$("#entropy-viewer").toggle(true);g=true}});$("#new-qlink-button-container").hide();$("#get-track").hide();$("#hash_result").hide();$("#sharing-container").hide();$(".alert-success").hide();$("[placeholder]").togglePlaceholder();flash_active=((typeof navigator.plugins!="undefined"&&typeof navigator.plugins["Shockwave Flash"]=="object")||(window.ActiveXObject&&(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))!=false));if(flash_active==true||flash_active=="true"){$("body").on("copy","#zclip",function(a){$("#share-menu").hide();a.clipboardData.clearData();a.clipboardData.setData("text/plain",$("#hash_result_text").val());a.preventDefault()})}else{$("#zclip").hide()}if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){is_mobile_or_tablet=true}if(/iPad|iPod/i.test(navigator.userAgent)){is_ipad_type=true}$("#qlink_textarea").on("input",function(){var a=parseInt($("#qlink_textarea").val().length);$(".leters-counter").html(2000-a)});$("#qlink_textarea").on("keydown",function(){var a=parseInt($("#qlink_textarea").val().length);$(".leters-counter").html(2000-a)});$("#trk").on("input",function(){trkCount("#trk")});$("#trk").on("keydown",function(a){trkCount("#trk");trkStatus(a,"#trk","#trk-status")});$("#trk2").on("input",function(){trkCount("#trk2")});$("#trk2").on("keydown",function(a){trkCount("#trk2");trkStatus(a,"#trk2","#trk-status2")});$("#trk-update").click(function(a){a.which=13;trkCount("#trk");trkStatus(a,"#trk","#trk-status")});$("#trk-update2").click(function(a){a.which=13;trkCount("#trk2");trkStatus(a,"#trk2","#trk-status2")})}function trkCount(d){var c=parseInt($(d).val().length);if(c>trkLength){$(d).val($(d).val().substring(0,trkLength))}}function trkStatus(j,f,h){var i=parseInt($(f).val().length);if(j.which==13&&i<trkLength){j.preventDefault()}$(h).html("");if(j.which==13&&i==trkLength){var g="/gtrkstatus";$.ajax({type:"post",dataType:"json",url:g,data:{trk:$(f).val()},success:function(a){if(a.status=="OK"){if(a.trkStatus==0){$(h).html(localeMessages.trk_unread)}else{if(a.trkStatus==1){$(h).html(localeMessages.trk_read)}else{$(h).html(localeMessages.trk_no_track)}}}else{$(h).html(localeMessages.trk_no_track)}},error:function(){},beforeSend:function(){}}).done(function(a){})}}function updateStrengthBar(b,a){if(points<=strongPoints){points++}if(b<800&&a<800&&points>700){points=700}if(b<600&&a<600&&points>400){points=400}if(b<200&&a<200&&points>150){points=150}if(b<100&&a<100&&points>60){points=60}entropy=points*100/strongPoints;entropy=entropy*70/100;if(entropy>70){entropy=70}var c=Math.round(255*entropy/100);var d=Math.round(255-c);if(points<=60){$("#strength-label").html(localeMessages.WEAK)}if(points>60&&points<=150){$("#strength-label").html(localeMessages.GOOD)}if(points>150&&points<=400){$("#strength-label").html(localeMessages.STRONG)}if(points>400&&points<=700){$("#strength-label").html(localeMessages.VERY_STRONG)}if(points>700){$("#strength-label").html(localeMessages.EXTREMELY_STRONG)}$("#entropy-viewer").html("....."+rawData.substring(rawData.length-300,rawData.length));$("#entropy-bar").css("width",entropy+"%")}function makeId(){password="";sha256.update((new Date().getTime()).toString());rawData=rawData+(new Date().getTime()).toString();var e=sha256.finalize();var h=CryptoJS.lib.WordArray.random(32);var g=Math.round(rawData.length/2);var d=CryptoJS.PBKDF2((new Date().getTime()).toString()+e.toString()+rawData.substring(0,g),h+rawData.substring(g+1,rawData.length),{keySize:256/32,iterations:2000});var f=Math.floor(Math.random()*(maxPasswordLength-minPasswordLength+1))+minPasswordLength;password=d.toString(CryptoJS.enc.Base64).substring(0,f);password=password.replace("+","");password=password.replace("+","")}function createQlink(){if(points<=20){$(".qlink-inner").block({message:$("#question-entropy"),css:{width:"275px"}});$("#ok-entropy").click(function(){$(".qlink-inner").unblock();return false});return}$("#li-entropy-container").hide();document.body.scrollTop=document.documentElement.scrollTop=0;$(".qlink-msj").block({message:"<div class='circles-loader'></div> <div>&#9817;&#9812;&#9817;</div>",css:{border:"none",padding:"10px",showOverlay:false,backgroundColor:"#fff","-webkit-border-radius":"0px","-moz-border-radius":"0px",opacity:1,color:"#000"},overlayCSS:{backgroundColor:"none"}});if(doesConnectionExist()==false){$(".qlink-msj").unblock();$(".qlink-msj").block({message:$("#question"),css:{width:"275px"}});$("#yes").click(function(){createQlink()});$("#no").click(function(){$(".qlink-msj").unblock();return false});return}$(".qlink-msj").unblock();$(".qlink-msj").block({message:"<div class='circles-loader'></div> <div>"+localeMessages.st_encrypting+"</div>",css:{border:"none",padding:"10px",showOverlay:false,backgroundColor:"#fff","-webkit-border-radius":"0px","-moz-border-radius":"0px",opacity:1,color:"#000"},overlayCSS:{backgroundColor:"none"}});sleep(1000,doCreateQlink,null)}var generatingQlink=false;var reintent=false;var readingQlink=false;var replyIntent="false";function doCreateQlink(){if(generatingQlink==true){return}generatingQlink=true;var x="/inject";var v=$("#qlink_textarea");var u=new Date();var i=u.getTime();var w=u.getTimezoneOffset();var q=$("#x_token");makeId();if(reintent==false){for(var p=0,o;o=encFiles[p];p++){encFiles[p]=aesEncrypt(encFiles[p])}}var s=false;var t=document.getElementById("imprint");var f=document.getElementById("captcha");var n=lastQl+"%%A%%"+v.val()+"%%C%%";if(s){n=aesEncrypt(LZW.compress(filterXSS(escapeHtmlEntities(n))));n.decom="true"}else{n=aesEncrypt(filterXSS(escapeHtmlEntities(n)));n.decom="false"}n=JSON.stringify(n);$.ajax({type:"post",dataType:"json",url:x,data:{files:encFiles,namesFiles:namesFiles,msg:n,imprint:t.checked,captcha:f.checked,randomHash:i,from:"web_app",x_token:q.val(),lang:localeCode,replyIntent:replyIntent,n:w},success:function(a){generatingQlink=false;reintent=false;if(a.status=="OK"){$("#major-text").html(localeMessages.share_it_trans);$("#read-title").show();var c=a.hash;var d=c+"#"+password;$("#hash_result_text").val(d);$("#quick_warning_message").hide();$("#expire_date").html(a.expireDate);$("#trk2").val(a.tn.split(" ")[1]);$("#trkspan").html(a.tn.split(" ")[1]);$("#tnlk").html(a.tnlk);$("#tnlk").attr("href",a.tnlk);$("#hash_result_text").on("keydown",function(e){if(e.metaKey==true||e.ctrlKey||e.shiftKey){return}$("#hash_result_text").val(d)});$("#hash_result_text").on("input",function(){$("#hash_result_text").val(d)});$("#hash_result").show();$("#hash_result_text").val(d).focus().select();$(".quick_success_message").show();$("#qlink_textarea_form").remove();$("#qlink_textarea").remove();$("#qlink-button-container").remove();$(".chk_imprint").remove();$("#new-qlink-button-container").show();$("#get-track").show();$("#form-files").hide();wsh=c+"%23"+password;if(is_mobile_or_tablet&&!is_ipad_type){$("#ws-share").attr("href","whatsapp://send?text=go secure: "+wsh);$("#sharing-container").show()}$("#tw-share").attr("href","https://twitter.com/intent/tweet?url=&text=go secure: "+wsh.replace(/\+/g,"%2B"));v.val();$("#new-qlink-button-container-mobile-container").show();$("#header").hide();$(".marketing-place-container").show();if(!is_mobile_or_tablet){qrConfig.text="go secure: "+d;var b=new QRCode(document.getElementById("qr-code-scan"),qrConfig)}document.body.scrollTop=document.documentElement.scrollTop=0}else{reintent=true;generatingQlink=false;$(".qlink-msj").unblock();$(".qlink-msj").block({message:$("#ajax-error"),css:{width:"275px"}});$("#ok").click(function(){reintent=true;generatingQlink=false;$(".qlink-msj").unblock()});return}},error:function(){reintent=true;generatingQlink=false;$(".qlink-msj").unblock();$(".qlink-msj").block({message:$("#ajax-error"),css:{width:"275px"}});$("#ok").click(function(){reintent=true;generatingQlink=false;$(".qlink-msj").unblock()});return},beforeSend:function(){$(".qlink-msj").block({message:"<div class='circles-loader'></div> <div>"+localeMessages.st_generating+"</div>",css:{border:"none",padding:"10px",showOverlay:false,backgroundColor:"#fff","-webkit-border-radius":"0px","-moz-border-radius":"0px",opacity:1,color:"#000"},overlayCSS:{backgroundColor:"none"}})}}).done(function(a){reintent=false;generatingQlink=false;if(a.status!="OK"){$(".qlink-msj").unblock()}else{$("#step-number").html("2");$("#step-text").html(localeMessages.tip_text_share)}})}function sendQlink(){var b=localeMessages.share_email_subject;window.location="mailto:?subject="+b+"&body=go secure: "+wsh}function readQlink(c,d){servDo=c;hashDo=d;$(".qlink-read").block({message:"<div class='circles-loader'></div> <div>"+localeMessages.st_loading+"</div>",css:{border:"none",padding:"10px",showOverlay:false,backgroundColor:"#fff","-webkit-border-radius":"0px","-moz-border-radius":"0px",opacity:1,color:"#000"},overlayCSS:{backgroundColor:"none"}});sleep(1000,doReadQlink,null)}var servDo;var hashDo;function validHash(d){var c=/^[a-zA-Z0-9+/]+={0,2}$/;return c.test(d)}function doReadQlink(){if(!validHash(location.hash.substring(1))){$("#container-read").remove();$(".copyright").hide();$("#invalid").show();return}var e=filterXSS(location.hash);password=e.substring(1);var f="/readmessage";var d=new Date().getTime();if(readingQlink==true){return}readingQlink=true;$.ajax({type:"post",dataType:"json",url:f,data:{from:"web_app",hash:hashDo,servnum:servDo,randomHash:d},success:function(a){readingQlink=false;if(a.status=="OK"){$("#result_container_area").html(a.data);var c=$("#links-area");var b=0;if(a.noMore==true){$(".hash_result_area").html(a.message);$("#reply-qlink-button").hide();$("#forward-qlink-button").hide();$("#forward-qlink-button-help").hide();$("#new-qlink-button").show();$("#quick_help_message").hide();$("#imprint_data").hide();c.hide();finishDecrypt(a)}else{$("#reply-qlink-button").show();$("#forward-qlink-button").show();$("#forward-qlink-button-help").show();$("#new-qlink-button").hide();$("#quick_help_message").show();b=1000;$(".qlink-read").block({message:"<div class='circles-loader'></div> <div>"+localeMessages.st_decrypting+"</div>",css:{border:"none",padding:"10px",showOverlay:false,backgroundColor:"#fff","-webkit-border-radius":"0px","-moz-border-radius":"0px",opacity:1,color:"#000"},overlayCSS:{backgroundColor:"none"}});sleep(b,doDecrypt,a)}}},error:function(){readingQlink=false;$(".qlink-read").unblock();$(".qlink-read").block({message:$("#ajax-error"),css:{width:"275px"}});$("#ok").click(function(){readingQlink=false;$(".qlink-read").unblock()});return},beforeSend:function(){}}).done(function(a){readingQlink=false});servDo=null;hashDo=null}function finishDecrypt(i){var h=i.encFiles;var g=i.namesFiles;var k=$("#links-area");if(h==null||h.length==0){k.hide();$(".attach-file").hide();$(".mjs-attach-files").hide()}else{$(".attach-file").show();$(".mjs-attach-files").show()}var j=i.hash;$("#resulttextarea").val(j);var l=i.imprint;if(l!=null){$("#imprint_text").html("qlinked from: "+l)}else{$("#imprint_text").html(localeMessages.imprint_not_used)}$(".title").html(location.protocol+"//"+location.host+"...");$(".qlink-read").unblock()}var lastQl="";function eStop(a){if(a.metaKey==true||a.ctrlKey||a.shiftKey){return}a.preventDefault();a.stopPropagation()}function doDecrypt(f){var i=$("#links-area");var w=JSON.parse(f.message);var o=aesDecrypt(w);if(!w.data){w=JSON.parse(w)}var t="true";if(w.decom){t=w.decom}var v=null;if(t=="true"){var v=LZW.decompress(o)}else{var v=o}var p=/<br\s*[\/]?>/gi;lastQl="";var y=v.indexOf("%%A%%");if(y==-1){v="%%A%%"+v+"%%C%%"}var x=v.split("%%A%%");if(x.length>2){for(var u=1;u<x.length;u++){if(u<(x.length-fwLimit)){continue}var s=x[u].split("%%C%%");s=s[0];s=unEscapeHtmlEntities(filterXSS(s.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(p,"\n")));lastQl=lastQl+"%%A%%"+s+"%%C%%";if(u%2==0){s="<div style='width:100%;display:inline-block'><textarea oninput='eStop(event)' onkeydown='eStop(event)' class='hash_result_area_p tx-res-more tx-res' onpaste='event.preventDefault();event.stopPropagation();return false;' oncut='event.preventDefault();event.stopPropagation();return false;'>"+s+"</textarea></div>"}else{s="<div style='width:100%;display:inline-block'><textarea oninput='eStop(event)' onkeydown='eStop(event)' class='hash_result_area_i tx-res-more tx-res' onpaste='event.preventDefault();event.stopPropagation();return false;' oncut='event.preventDefault();event.stopPropagation();return false;'>"+s+"</textarea></div>"}$(".hash_result_area").css("background","none");$(".hash_result_area").html($(".hash_result_area").html()+s)}}else{var s=x[1].split("%%C%%");s=s[0];s=unEscapeHtmlEntities(filterXSS(s.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(p,"\n")));lastQl="%%A%%"+s+"%%C%%";s="<textarea class='tx-res-one-only tx-res' oninput='eStop(event)' onkeydown='eStop(event)' onpaste='event.preventDefault();event.stopPropagation();return false;' oncut='event.preventDefault();event.stopPropagation();return false;' style='height: 100%;width: 100%;'>"+s+"</textarea>";$(".hash_result_area").html(s)}$(".tx-res").autosize();$("#msg-scroll-container").scrollTop($("#msg-scroll-container")[0].scrollHeight);var q=f.encFiles;namesFiles=f.namesFiles;if(q!=null){for(var u=0,r;r=q[u];u++){dencFiles[u]=aesDecrypt(JSON.parse(q[u]));if(msieVersion()){i.append("<li class='fa-paper-plane'><a href='#' class='clearfix' onclick='downloadUriForIE("+u+")'><div class='icon'></div><div class='file-name'>"+unescape(namesFiles[u])+"</div><div class='tool-dl'></div></a>")}else{i.append("<li class='fa-paper-plane'><a href='"+dencFiles[u]+"' target='_blank' download='"+namesFiles[u]+"' class='clearfix' ><div class='icon'></div><div class='file-name'>"+unescape(namesFiles[u])+"</div><div class='tool-dl'></div></a>")}}}finishDecrypt(f)}function downloadUriForIE(c){var d=dataURItoBlob(dencFiles[c]);saveAs(d,unescape(namesFiles[c]))}$(function(){$(".normal").autosize();$(".animated").autosize()});$.fn.togglePlaceholder=function(){return this.each(function(){$(this).data("holder",$(this).attr("placeholder")).focusin(function(){$(this).attr("placeholder","")}).focusout(function(){$(this).attr("placeholder",$(this).data("holder"))})})};function finishLoad(f,g,h){if(f.lenght>(1048576*4/3)){$("#msg-error").html("<span>"+localeMessages.max_file_size+"</span>");$("#msg-error").show();$(".qlink-msj").unblock();totalIndex--;if(totalIndex==0){$(".file-input-wrapper").show();$("#files").show()}return}ident=totalIndex-1;var e=document.createElement("span");encFiles[ident]=f;if(encFiles[ident]==null){$("#msg-error").html("<span>"+localeMessages.error_encrypt_file+"</span>");$("#msg-error").show()}$("#msg-error").hide();namesFiles[ident]=escape(h.name);e.className="attach";e.innerHTML=["File: ",h.name,'<img class="delattach" src="/images/delete.png" onclick="clearAt(this,\''+namesFiles[ident]+"')\"/><br/>"].join("");document.getElementById("list").insertBefore(e,null)}var ident=0;function handleFileSelect(f){var i=f.target.files;ident=0;for(var j=0,h;h=i[j];j++){$(".qlink-msj").block({message:"<div class='circles-loader'></div> <div>"+localeMessages.st_loading_image+"</div>",css:{border:"none",padding:"10px",showOverlay:false,backgroundColor:"#fff","-webkit-border-radius":"0px","-moz-border-radius":"0px",opacity:1,color:"#000"},overlayCSS:{backgroundColor:"none"}});var g=new FileReader();g.onload=(function(a){return function(d){var e=d.target.result;var b=a.type;if(b=="image/jpeg"||b=="image/png"){if(a.size>1048576){var c=a.size/1048576;resizeImg(e,c,b,a)}else{finishLoad(e,b,a);$(".qlink-msj").unblock()}}else{if(a.size>1048576){$("#msg-error").html("<span>"+localeMessages.max_file_size+"</span>");$("#msg-error").show();$(".qlink-msj").unblock();totalIndex--;if(totalIndex==0){$(".file-input-wrapper").show();$("#files").show()}return}finishLoad(e,b,a);$(".qlink-msj").unblock()}}})(h);g.onerror=function(a){$("#msg-error").html("<span>"+localeMessages.error_file+"</span>");$("#msg-error").show()};g.onabort=function(a){$("#msg-error").html("<span>"+localeMessages.abort_file+"</span>");$("#msg-error").show()};g.readAsDataURL(h);totalIndex++;if(totalIndex>0){$(".file-input-wrapper").hide();$("#files").hide()}}}function resizeImg(l,i,j,k){var g=document.createElement("canvas");var h=new Image();h.onload=function(){g.width=h.width;g.height=h.height;var b=g.getContext("2d");g.height=g.height/i;g.width=g.width/i;b.scale(1/i,1/i);b.drawImage(h,0,0);var a=g.toDataURL(j);finishLoad(a,j,k);$(".qlink-msj").unblock()};h.src=l;return}function clearAt(d,e){var f=namesFiles.indexOf(e);encFiles.splice(f,1);namesFiles.splice(f,1);totalIndex--;d.parentElement.remove();if(totalIndex==0){$(".file-input-wrapper").show();$("#files").show()}}function aesEncrypt(k){var n=CryptoJS.lib.WordArray.random(8).toString();var p=CryptoJS.lib.WordArray.random(32).toString();p=p.substring(0,32);var j=100;var o=CryptoJS.PBKDF2(password,CryptoJS.enc.Hex.parse(n),{keySize:8,iterations:j});var l=CryptoJS.AES.encrypt(k,o,{iv:CryptoJS.enc.Hex.parse(p)});var m=l.ciphertext.toString(CryptoJS.enc.Base64);var i={data:m,salt:n,iv:p,iter:j,decom:"true"};return i}function aesDecrypt(i){if(!i.data){i=JSON.parse(i)}var l=CryptoJS.lib.CipherParams.create({ciphertext:CryptoJS.enc.Base64.parse(i.data)});var g=500;if(i.iter){g=i.iter}var k=CryptoJS.PBKDF2(password,CryptoJS.enc.Hex.parse(i.salt),{keySize:8,iterations:g});var h=CryptoJS.AES.decrypt(l,k,{iv:CryptoJS.enc.Hex.parse(i.iv)});var j=h.toString(CryptoJS.enc.Utf8);return j}function sleep(e,f,d){if(d!=null){setTimeout(function(){f(d)},e)}else{setTimeout(function(){f()},e)}}function escapeHtmlEntities(b){b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");b=b.replace(/&/g,"&amp;");b=b.replace(/¢/g,"&cent;");b=b.replace(/£/g,"&pound;");b=b.replace(/¥/g,"&yen;");b=b.replace(/€/g,"&euro;");b=b.replace(/§/g,"&sect;");b=b.replace(/©/g,"&copy;");b=b.replace(/®/g,"&reg;");b=b.replace(/™/g,"&trade;");b=b.replace(/"/g,"&quot;");b=b.replace(/'/g,"&apos;");return b}function unEscapeHtmlEntities(b){b=b.replace(/&amp;/g,"&");b=b.replace(/&lt;/g,"<");b=b.replace(/&gt;/g,">");b=b.replace(/&cent;/g,"¢");b=b.replace(/&pound;/g,"£");b=b.replace(/&yen;/g,"¥");b=b.replace(/&euro;/g,"€");b=b.replace(/&sect;/g,"§");b=b.replace(/&copy;/g,"©");b=b.replace(/&reg;/g,"®");b=b.replace(/&trade;/g,"™");b=b.replace(/&quot;/g,'"');b=b.replace(/&apos;/g,"'");return b}function doesConnectionExist(){var g=new XMLHttpRequest();var f=jsConfig.url_check_connection;var e=Math.round(Math.random()*10000);g.open("HEAD",f+"?rand="+e,false);try{g.send();if(g.status>=200&&g.status<304){return true}else{return false}}catch(h){return false}}function doReply(){location.href="/?reply=t"}function doForward(){dencFiles=[];totalIndex=0;encFiles=[];namesFiles=[];sha256=null;password=null;wsh="";init();var b="/forward";$.ajax({type:"post",dataType:"json",url:b,data:{},success:function(a){if(a.status=="OK"){$("#major-text").html(localeMessages.write_reply);$("#read-title").show();$(".content").remove();$("#xres").html(a.data);$("#response-container").show();$(".form-container").css("width","inherit");$("#last-qlink-message").removeClass("quick_message_title");$("#last-qlink-message").addClass("last_quick_message_title");$("#last-qlink-message").html("<p> >> "+localeMessages.history_include+"</p>")}},error:function(){}})}function checkBrSupport(){var c=true;if(navigator.userAgent.indexOf("Opera Mini")!=-1){c=false}if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var d=new Number(RegExp.$1);if(d<=9&&d>=5){c=false}}if(navigator.whoVersion=="Safari 5"){c=false}if(navigator.whoVersion=="IE 7"){c=false}if(navigator.whoVersion=="IE 8"){c=false}if(navigator.whoVersion=="IE 9"){c=false}if(!c){$("#footer").remove();$("#container-read").remove();$("#quick_help").remove();$("#unsupport").show()}else{}return c}navigator.whoVersion=(function(){var d=navigator.userAgent,e,f=d.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(f[1])){e=/\brv[ :]+(\d+)/g.exec(d)||[];return"IE "+(e[1]||"")}if(f[1]==="Chrome"){e=d.match(/\bOPR\/(\d+)/);if(e!=null){return"Opera "+e[1]}}f=f[2]?[f[1],f[2]]:[navigator.appName,navigator.appVersion,"-?"];if((e=d.match(/version\/(\d+)/i))!=null){f.splice(1,1,e[1])}return f.join(" ")})();function msieVersion(){var c=window.navigator.userAgent;var d=c.indexOf("MSIE ");if(d>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){return true}return false}function dataURItoBlob(f){var h;if(f.split(",")[0].indexOf("base64")>=0){h=atob(f.split(",")[1])}else{h=unescape(f.split(",")[1])}var g=f.split(",")[0].split(":")[1].split(";")[0];var j=new Uint8Array(h.length);for(var i=0;i<h.length;i++){j[i]=h.charCodeAt(i)}return new Blob([j],{type:g})};